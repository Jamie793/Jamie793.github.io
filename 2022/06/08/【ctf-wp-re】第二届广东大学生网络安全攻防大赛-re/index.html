<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>【CTF&amp;Re&amp;WriteUp】第二届广东大学生网络安全攻防大赛ReWP | Jamie793’ S Blog</title><meta name="keywords" content="C++,CTF,Reverse"><meta name="author" content="Jamie793"><meta name="copyright" content="Jamie793"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="LUOJIABASUO   半个月前参加了一场比赛，我主要是负责的Re但是只解出了一个比较简单的那就是Pyre其他的我打开来看了一下就关了甚至没调试。后来发现还是挺简单的一个题目  RE反调试   首先老规矩IDA打开静态分析看看，发现压根无法分析。主要是这里使用了虚表调用。虚表调用的子程序（函数）是在每次运行的时候才计算出来子程序的地址。这导致IDA分析的时候是无法对齐静态的分析的。所以">
<meta property="og:type" content="article">
<meta property="og:title" content="【CTF&amp;Re&amp;WriteUp】第二届广东大学生网络安全攻防大赛ReWP">
<meta property="og:url" content="https://blog.jamiexu.cn/2022/06/08/%E3%80%90ctf-wp-re%E3%80%91%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B9%BF%E4%B8%9C%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B-re/index.html">
<meta property="og:site_name" content="Jamie793’ S Blog">
<meta property="og:description" content="LUOJIABASUO   半个月前参加了一场比赛，我主要是负责的Re但是只解出了一个比较简单的那就是Pyre其他的我打开来看了一下就关了甚至没调试。后来发现还是挺简单的一个题目  RE反调试   首先老规矩IDA打开静态分析看看，发现压根无法分析。主要是这里使用了虚表调用。虚表调用的子程序（函数）是在每次运行的时候才计算出来子程序的地址。这导致IDA分析的时候是无法对齐静态的分析的。所以">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png">
<meta property="article:published_time" content="2022-06-08T11:34:44.000Z">
<meta property="article:modified_time" content="2022-07-29T04:24:38.706Z">
<meta property="article:author" content="Jamie793">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png"><link rel="shortcut icon" href="https://s2.loli.net/2022/07/29/exB2qQKoj37pCIl.png"><link rel="canonical" href="https://blog.jamiexu.cn/2022/06/08/%E3%80%90ctf-wp-re%E3%80%91%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B9%BF%E4%B8%9C%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B-re/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?664887908a77afdcd7d6f3c5ff5c0c45";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":20,"languages":{"author":"作者: Jamie793","link":"链接: ","source":"来源: Jamie793’ S Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【CTF&Re&WriteUp】第二届广东大学生网络安全攻防大赛ReWP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-29 12:24:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Jamie793’ S Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/07/29/exB2qQKoj37pCIl.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">71</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">24</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友人</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jamie793’ S Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友人</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【CTF&amp;Re&amp;WriteUp】第二届广东大学生网络安全攻防大赛ReWP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-08T11:34:44.000Z" title="发表于 2022-06-08 19:34:44">2022-06-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-29T04:24:38.706Z" title="更新于 2022-07-29 12:24:38">2022-07-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/Reverse/">Reverse</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【CTF&amp;Re&amp;WriteUp】第二届广东大学生网络安全攻防大赛ReWP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="LUOJIABASUO"><a href="#LUOJIABASUO" class="headerlink" title="LUOJIABASUO"></a>LUOJIABASUO</h1><ul>
<li>  半个月前参加了一场比赛，我主要是负责的Re但是只解出了一个比较简单的那就是Pyre其他的我打开来看了一下就关了甚至没调试。后来发现还是挺简单的一个题目</li>
</ul>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="反调试"><a href="#反调试" class="headerlink" title="反调试"></a>反调试</h2><ul>
<li>  首先老规矩IDA打开静态分析看看，发现压根无法分析。主要是这里使用了虚表调用。虚表调用的子程序（函数）是在每次运行的时候才计算出来子程序的地址。这导致IDA分析的时候是无法对齐静态的分析的。所以</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/pyjhJQ3LiKUwRnN.png"></p>
<ul>
<li>  按照老规矩动态调试挂起来，发现IDA没有控制权无法控制程序当程序运行起来的 时候没有响应切不能在IDA结束远程的调试目标。那说明存在反调试。</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/XWqJR5B7b6H9lne.png"></p>
<ul>
<li>  如何寻找反调试的地方在哪呢？也挺简单的只要在入口处下个断点不断的运行程序看看哪里IDA没有控制权了那么说明该地方具有反调试</li>
<li>  要注意的 是main函数不是最开始的入口，”__scrt_common_main_seh“ 这个子程序才是最开始执行的</li>
</ul>
<blockquote>
<p>引用来自<a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/relic256/topics/1212274">https://www.dazhuanlan.com/relic256/topics/1212274</a></p>
<p>虽然 VS 系列入口函数均为<code>mainCRTStartup</code>，但不同版本的实现仍然有些许不同。 在 VC6.0 中，可通过 API<code>GetVersion</code>、<code>GetCommandLine</code>来找到入口函数。而<code>main</code>函数是其中唯一一个 3 个参数的函数，故可以通过找 3 个 push 来找到<code>main</code>函数 (<code>WinMain</code>为 4 个 push)。 在 VS2013 中，开始先使用<code>__security_init_cookie</code>函数初始化 cookie(/GS 选项需要使用的，详见)，再进入<code>_tmainCRTStartup</code>中进行类似 VC6 中的类似初始化。这在 Debug 版的汇编中体现为一个 jmp 后两个连续的 call，而<code>main</code>函数在第二个 call 当中。在 Release 版中，因为优化而入口处直接便是一个 call 后接一个 jmp，而<code>main</code>函数在 jmp 中。 在 VS2015 中，<code>mainCRTStartup</code>函数中只有<code>__scrt_common_main</code>函数，在这个函数中先调用<code>__security_init_cookie</code>，再调用<code>__scrt_common_main_seh</code>，在<code>__scrt_common_main_seh</code>中进行类似 VC6 的初始化，其后使用<code>invoke_main</code>来调用<code>main</code>函数 (或者其他版本的 main)。这些在 Debug 版的汇编中体现为一个 jmp 后一个 call，再后两个连续的 call，而<code>main</code>函数在第二个 call 中的<code>invoke_main</code>当中。</p>
</blockquote>
<ul>
<li>  所以我们不能直接在main函数的入口下断，而是在<code>__scrt_common_main_seh</code>的领空下断</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/1ch4p2UaQTOVnSl.png"><img src="https://s2.loli.net/2022/07/29/1P3XlwBC8hpZKiQ.png"></p>
<ul>
<li>  发现调用了_initterm后就就是去了控制权，这个函数看样子应该是标准库的函数</li>
</ul>
<blockquote>
<p>引用来自<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/initterm-initterm-e?view=msvc-170">https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/initterm-initterm-e?view=msvc-170</a></p>
<p>Internal methods that walk a table of function pointers and initialize them. The first pointer is the starting location in the table and the second pointer is the ending location.</p>
</blockquote>
<ul>
<li>  看不懂没关系，因为我也看不懂哈哈哈哈。我猜测应该就是初始化。直接重新打开程序挂起动态跟进程序看看。可以看到循环调用了一个类似IAT表一样的表里的函数。这里可以单步调试看看RAX值为啥的时候IDA失去控制权也可以用跟踪。这里我用单步调试</li>
<li>  在call地方下个断点然后运行程序查看每次断下来后RAX的变化。发现当RAX为0x00007FF729431170的时候IDA失去了控制权</li>
<li>  直接跟进发现调用了一个子程序</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/8yxPNBWhUzLfCAc.png"><img src="https://s2.loli.net/2022/07/29/BaIFWZvLTqXOpKn.png"></p>
<ul>
<li>  F7跟进后在该子程序中发现了反调试主要是NtSetInformationThread</li>
</ul>
<blockquote>
<p>引用来自<a target="_blank" rel="noopener" href="https://anti-debug.checkpoint.com/techniques/interactive.html#ntsetinformationthread">https://anti-debug.checkpoint.com/techniques/interactive.html#ntsetinformationthread</a></p>
<p>The function ntdll!NtSetInformationThread() can be used to hide a thread from a debugger. It is possible with a help of the undocumented value THREAD_INFORMATION_CLASS::ThreadHideFromDebugger (0x11). This is intended to be used by an external process, but any thread can use it on itself. After the thread is hidden from the debugger, it will continue running but the debugger won’t receive events related to this thread. This thread can perform anti-debugging checks such as code checksum, debug flags verification, etc. However, if there is a breakpoint in the hidden thread or if we hide the main thread from the debugger, the process will crash and the debugger will be stuck. In the example, we hide the current thread from the debugger. This means that if we trace this code in the debugger or put a breakpoint to any instruction of this thread, the debugging will be stuck once ntdll!NtSetInformationThread() is called.</p>
</blockquote>
<ul>
<li>  意思是程序对调试器隐藏了线程，导致调试器无法找到线程来实现反调试</li>
<li>  知道了反调试在这后可以直接对其NOP，BUT！！！我发现NOP后每当程序运行起来会把该地方NOP的指令进行还原执行</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/oLhq5Y6krGHb3lV.png"></p>
<ul>
<li>  可以直接修改属性达到执行了函数并不会隐藏线程，把所有断点去掉后程序可以正常运行，IDA也获得了程序的控制权</li>
<li>  但以为这就完了吗？No！这个程序很多地方都有反调试主要是调用了IsDebuggerPresent检测调试器的标志位，直接在IAT导入表查看IsDebuggerPresent的交叉引用</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/kNZ4AfpzFYSEJix.png"></p>
<ul>
<li>  发现有三个地方调用了该函数，解决方法和上面那个反调试的方法一样把返回值改了就行。</li>
<li>  记得在函数执行后修改EAX = 0即可</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/3UPWZLr2YflItSJ.png"></p>
<ul>
<li>  对所有引用的地方都设置好了之后回到main中下个断运行程序开始正题</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/dTmVvh64fXSnzGc.png"></p>
<h2 id="逻辑分析"><a href="#逻辑分析" class="headerlink" title="逻辑分析"></a>逻辑分析</h2><ul>
<li>  运行后发现首先判断了输入的flag的长度是否为36（这里有个技巧如果看到的不是十进制的值可以点击十六进制按H互相转换），重新运行输入36位flag</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/SDNmVMlJfeFajZh.png"></p>
<ul>
<li>  首先分配大小为0x10大小的内存空间，把内存空间的地址存放到栈里</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/Z7pYzHI3MxT5jWG.png"></p>
<ul>
<li>  继续执行调用了一个函数跟进分析发现其主要是把用户输入的flag所存放的位置的地址和一个 <code>Base::vftable</code>子程序的地址分别存放到一个连续的内存中（可理解为数组）</li>
<li>  继续发现调用了刚刚的子程序</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/fKGEk5hDlqJsiYe.png"><img src="https://s2.loli.net/2022/07/29/Is495qvmxM7ikXZ.png"><img src="https://s2.loli.net/2022/07/29/OHWbAcpkhtLzxy6.png"></p>
<ul>
<li>  对比数据加密前后发现是反置了比特位，如13的二进制是1011反置后为1101。不理解就当作是加密，把用户输入的每个字符进行了比特位反置</li>
<li>  继续跟进发现了一个暂时不知道干嘛的函数，先记一下他就是对数据进行了赋值操作。了解一下后面需要的时候再回来分析</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/TLmOyBEblWxI5Xf.png"><img src="https://s2.loli.net/2022/07/29/HlT4qMe1y3orFcu.png"></p>
<ul>
<li>  当直接执行了sub_7FF729432110子程序后发现程序直接闪退了，跟进看看。猜测可能又是反调试</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/1dMgqXIiDbA6v89.png"></p>
<ul>
<li>具体可以参考<ul>
<li>  <a target="_blank" rel="noopener" href="https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software">https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software</a></li>
<li>  <a target="_blank" rel="noopener" href="https://anti-debug.checkpoint.com/techniques/process-memory.html">https://anti-debug.checkpoint.com/techniques/process-memory.html</a></li>
</ul>
</li>
<li>  这里我直接老规矩</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/CXouZfti4aqSxLF.png"></p>
<ul>
<li>  又发现了一个call直接跟进，发现是解密用用户输入的前4位解密数据存放到lpAddress中</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/WZepk9Jt2lBOiIx.png"><img src="https://s2.loli.net/2022/07/29/kWsJZlKR8PEL1a9.png"></p>
<ul>
<li>  有函数继续跟进，跟进发现又是赋值先看一眼后面需要用到参数再回来分析。但里面还调用了子程序逐个走进去看看。发现开辟了一个线程执行子程序查看一下子程序主要的作用是啥</li>
<li>  发现是对解密的数据进行逐个检查判断是否有0xCC如果有就退出程序</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/73HLZGho6SeviyA.png"><img src="https://s2.loli.net/2022/07/29/4or7pWbG3UBIwNP.png"><img src="https://s2.loli.net/2022/07/29/DlNOKcSu1sehaWm.png"></p>
<ul>
<li>  有函数直接跟进去分析发现把刚刚解密的数据当成子程序执行</li>
<li>  那么可以猜测这是SMC（Self Modify Code）</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/rAV9MsoEz7SNR6x.png"><img src="https://s2.loli.net/2022/07/29/2Oa1gzQy3lKBZFS.png"></p>
<ul>
<li>  现在就需要把该数据正确的解密出来才可以知道算法是啥。唯一能想到的就是爆破。</li>
<li>如果是子程序那么有一下几个特征<ul>
<li>  开头必须是<code>mov</code> 或 <code>push</code></li>
<li>  如果是<code>push</code>的时候必须是<code>push rbp</code></li>
<li>  结尾必须是<code>ret</code></li>
</ul>
</li>
<li>  其中根据结尾是ret可以直接把加密后的最后一个字节和ret指令码进行异或得到0xE密钥是4位已经解出了一位但是哪一位不知道</li>
<li>  根据下图可得知用231 % 4后就是最后一次的下标为3</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/kWsJZlKR8PEL1a9.png"></p>
<ul>
<li>  现在知道了最后一位了还有3位直接根据前面的规则写出爆破。这里需要借助Capstone</li>
<li>  本来是使用Python编写的但发现性能真的太慢了直接用C艹，下面贴出代码</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;capstone/capstone.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> smc_code[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x27</span>, <span class="number">0x44</span>, <span class="number">0x7F</span>, <span class="number">0xEB</span>, <span class="number">0x3A</span>, <span class="number">0x8F</span>, <span class="number">0x1A</span>, <span class="number">0x2E</span>, <span class="number">0xFB</span>, <span class="number">0x41</span>,</span><br><span class="line">  <span class="number">0xE6</span>, <span class="number">0x46</span>, <span class="number">0xFB</span>, <span class="number">0x59</span>, <span class="number">0xEE</span>, <span class="number">0x42</span>, <span class="number">0xFB</span>, <span class="number">0x49</span>, <span class="number">0xD6</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0xF9</span>, <span class="number">0x49</span>, <span class="number">0xEE</span>, <span class="number">0x85</span>, <span class="number">0x72</span>, <span class="number">0x85</span>, <span class="number">0xB3</span>, <span class="number">0xF6</span>, <span class="number">0x3A</span>, <span class="number">0x87</span>,</span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0x16</span>, <span class="number">0xF9</span>, <span class="number">0x4C</span>, <span class="number">0xF2</span>, <span class="number">0x87</span>, <span class="number">0x37</span>, <span class="number">0xF8</span>, <span class="number">0x31</span>, <span class="number">0x4B</span>,</span><br><span class="line">  <span class="number">0x82</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x72</span>, <span class="number">0xCB</span>, <span class="number">0xB3</span>, <span class="number">0xE2</span>, <span class="number">0x0D</span>, <span class="number">0xA0</span>,</span><br><span class="line">  <span class="number">0x9C</span>, <span class="number">0x89</span>, <span class="number">0xB5</span>, <span class="number">0x49</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x85</span>,</span><br><span class="line">  <span class="number">0x37</span>, <span class="number">0xF0</span>, <span class="number">0xCD</span>, <span class="number">0x4B</span>, <span class="number">0x62</span>, <span class="number">0x03</span>, <span class="number">0x75</span>, <span class="number">0x8A</span>, <span class="number">0x72</span>, <span class="number">0x0C</span>,</span><br><span class="line">  <span class="number">0xF6</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xF8</span>, <span class="number">0x7B</span>, <span class="number">0x1A</span>, <span class="number">0xB7</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>,</span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0x87</span>, <span class="number">0xB3</span>, <span class="number">0xFA</span>, <span class="number">0xB3</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0x3F</span>, <span class="number">0xB0</span>, <span class="number">0x87</span>,</span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0xFA</span>, <span class="number">0x73</span>, <span class="number">0xCE</span>, <span class="number">0x7D</span>, <span class="number">0x4B</span>, <span class="number">0x82</span>, <span class="number">0x8F</span>, <span class="number">0x16</span>, <span class="number">0x0D</span>,</span><br><span class="line">  <span class="number">0x3A</span>, <span class="number">0x81</span>, <span class="number">0xFA</span>, <span class="number">0x8B</span>, <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x3A</span>, <span class="number">0x87</span>,</span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0x2E</span>, <span class="number">0x3A</span>, <span class="number">0x0D</span>, <span class="number">0x3E</span>, <span class="number">0x85</span>, <span class="number">0x7A</span>, <span class="number">0x87</span>, <span class="number">0xB3</span>, <span class="number">0xFE</span>,</span><br><span class="line">  <span class="number">0x73</span>, <span class="number">0xC4</span>, <span class="number">0xC7</span>, <span class="number">0xDE</span>, <span class="number">0x73</span>, <span class="number">0x49</span>, <span class="number">0x0E</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xE0</span>,</span><br><span class="line">  <span class="number">0xF7</span>, <span class="number">0x4B</span>, <span class="number">0x82</span>, <span class="number">0x87</span>, <span class="number">0xB3</span>, <span class="number">0xF6</span>, <span class="number">0xFF</span>, <span class="number">0x18</span>, <span class="number">0x33</span>, <span class="number">0x0E</span>,</span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xF4</span>, <span class="number">0x37</span>, <span class="number">0xE6</span>, <span class="number">0x74</span>, <span class="number">0x3D</span>,</span><br><span class="line">  <span class="number">0x34</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xF4</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0xF9</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0xCF</span>,</span><br><span class="line">  <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x7F</span>, <span class="number">0xCE</span>, <span class="number">0xF1</span>, <span class="number">0xEC</span>, <span class="number">0xF5</span>, <span class="number">0x46</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x73</span>, <span class="number">0x0E</span>, <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x46</span>, <span class="number">0xF9</span>, <span class="number">0x49</span>, <span class="number">0xD6</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x73</span>, <span class="number">0xC4</span>, <span class="number">0x7D</span>, <span class="number">0x06</span>, <span class="number">0xF9</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x0F</span>, <span class="number">0xBA</span>, <span class="number">0x3D</span>,</span><br><span class="line">  <span class="number">0x26</span>, <span class="number">0x0F</span>, <span class="number">0x37</span>, <span class="number">0xF8</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x8E</span>, <span class="number">0x0D</span>, <span class="number">0x1F</span>, <span class="number">0x7E</span>,</span><br><span class="line">  <span class="number">0x8D</span>, <span class="number">0xF3</span>, <span class="number">0x09</span>, <span class="number">0x46</span>, <span class="number">0xF9</span>, <span class="number">0x49</span>, <span class="number">0xEE</span>, <span class="number">0x85</span>, <span class="number">0x27</span>, <span class="number">0xF4</span>,</span><br><span class="line">  <span class="number">0x7F</span>, <span class="number">0x1E</span>, <span class="number">0x3A</span>, <span class="number">0x87</span>, <span class="number">0xB3</span>, <span class="number">0x16</span>, <span class="number">0x3A</span>, <span class="number">0x8F</span>, <span class="number">0x36</span>, <span class="number">0x0A</span>,</span><br><span class="line">  <span class="number">0xF9</span>, <span class="number">0x59</span>, <span class="number">0x02</span>, <span class="number">0x87</span>, <span class="number">0x62</span>, <span class="number">0x9C</span>, <span class="number">0xBE</span>, <span class="number">0x8D</span>, <span class="number">0xB6</span>, <span class="number">0x2C</span>,</span><br><span class="line">  <span class="number">0xAB</span>, <span class="number">0xCD</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverseBit</span><span class="params">(<span class="type">uint8_t</span>* data, <span class="type">size_t</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v = *(data + i);</span><br><span class="line">        v = (v &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>  (v &amp; <span class="number">0x55</span>) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        v = (v &amp; <span class="number">0xCC</span>) &gt;&gt; <span class="number">2</span>  (v &amp; <span class="number">0x33</span>) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">        v = (v &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>  (v &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">        *(data + i) = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checkIsValid</span><span class="params">(<span class="type">uint8_t</span>* key, <span class="type">uint8_t</span> *oriKey)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint8_t</span> buff[<span class="built_in">sizeof</span>(smc_code)];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sizeof</span>(smc_code); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        buff[i] = smc_code[i] ^ *(key + (i % <span class="number">4</span>));</span><br><span class="line">        <span class="keyword">if</span> (buff[i] == <span class="number">0xCC</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    csh handle;</span><br><span class="line">    cs_insn* insn;</span><br><span class="line">    <span class="type">size_t</span> count;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cs_open</span>(CS_ARCH_X86, CS_MODE_64, &amp;handle) != CS_ERR_OK)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    count = <span class="built_in">cs_disasm</span>(handle, buff, <span class="built_in">sizeof</span>(buff), <span class="number">0x1000</span>, <span class="number">0</span>, &amp;insn);</span><br><span class="line">    <span class="keyword">if</span> (count &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cs_free</span>(insn, count);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (insn[<span class="number">0</span>].id != X86_INS_PUSH &amp;&amp; insn[<span class="number">0</span>].id != X86_INS_MOV &amp;&amp; insn[count - <span class="number">1</span>].id != X86_INS_RET)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cs_free</span>(insn, count);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; count; i++)sum += insn[i].size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (sum == <span class="number">232</span> &amp;&amp; !\s\t\r\c\m\<span class="built_in">p</span>(insn[<span class="number">0</span>].op_str, rbp)) &#123;</span><br><span class="line">        <span class="built_in">reverseBit</span>(oriKey+<span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(key: %s\t\t0x%x:\t%s\t\t%s\n, oriKey , (<span class="type">int</span>)insn[<span class="number">0</span>].address, insn[<span class="number">0</span>].mnemonic, insn[<span class="number">0</span>].op_str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cs_free</span>(insn, count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">5</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    key[<span class="number">3</span>] = <span class="number">0x0E</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> waitKey[<span class="number">0x7F</span> - <span class="number">0x21</span>];</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0x21</span>; i &lt; <span class="number">0x7F</span>; i++)</span><br><span class="line">        waitKey[i - <span class="number">0x21</span>] = i;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(smc len: %u\n, <span class="built_in">sizeof</span>(smc_code));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sizeof</span>(waitKey); i++)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; <span class="built_in">sizeof</span>(waitKey); j++)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">size_t</span> k = <span class="number">0</span>; k &lt; <span class="built_in">sizeof</span>(waitKey); k++)</span><br><span class="line">            &#123;</span><br><span class="line">                key[<span class="number">0</span>] = waitKey[i];</span><br><span class="line">                key[<span class="number">1</span>] = waitKey[j];</span><br><span class="line">                key[<span class="number">2</span>] = waitKey[k];</span><br><span class="line">                <span class="type">unsigned</span> <span class="type">char</span> oriKey[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">                <span class="built_in">strcpy</span>((<span class="type">char</span> *)oriKey, (<span class="type">const</span> <span class="type">char</span>*)key);</span><br><span class="line">                <span class="built_in">reverseBit</span>(key, <span class="number">3</span>);</span><br><span class="line">                <span class="built_in">checkIsValid</span>(key,oriKey);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>  爆破出几个一个个尝试发现是N0op，代入运行可以看到是一个魔改的TEA加密</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/lKX1LJfwNEOqAgQ.png"><img src="https://s2.loli.net/2022/07/29/DZaywBC85fJG73z.png"></p>
<ul>
<li>  继续分析发现加密后使用strncmp进行数据的比较</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/9Kn7feNu8JFQ6Wj.png"></p>
<ul>
<li>  值得注意的是这里调用了两次分别对输入的不同位置进行了加密，使用了不同的密钥</li>
<li>  下下面直接上代码</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/ZMPW9ydUfsNqr23.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">teaDecrypt</span><span class="params">(<span class="type">uint32_t</span>*data, <span class="type">uint32_t</span> *key, <span class="type">size_t</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> v0 = *data;</span><br><span class="line">    <span class="type">uint32_t</span> v1 = *(data+<span class="number">1</span>);</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x876AAC7F</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = delta * size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        v1 -= (v0 + ((v0 &gt;&gt; <span class="number">6</span>) ^ (<span class="number">8</span> * v0))) ^ (*(((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>) + key) + sum);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (v1 + ((v1 &gt;&gt; <span class="number">6</span>) ^ (<span class="number">8</span> * v1))) ^ (*((sum &amp; <span class="number">3</span>) + key) + sum);</span><br><span class="line">    &#125;</span><br><span class="line">    *data = v0;</span><br><span class="line">    *(data+<span class="number">1</span>) = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverseBit</span><span class="params">(<span class="type">uint8_t</span>* data, <span class="type">size_t</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> v = *(data + i);</span><br><span class="line">        v = (v &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>  (v &amp; <span class="number">0x55</span>) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        v = (v &amp; <span class="number">0xCC</span>) &gt;&gt; <span class="number">2</span>  (v &amp; <span class="number">0x33</span>) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">        v = (v &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>  (v &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">        *(data + i) = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checkIsValid</span><span class="params">(<span class="type">uint8_t</span>* key, <span class="type">uint8_t</span> *oriKey)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> data[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0x72</span>, <span class="number">0x0C</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x8C</span>, <span class="number">0x69</span>, <span class="number">0x23</span>, <span class="number">0x69</span>, <span class="number">0x59</span>, <span class="number">0xA8</span>,</span><br><span class="line">      <span class="number">0x06</span>, <span class="number">0xEF</span>, <span class="number">0x2A</span>, <span class="number">0x1A</span>, <span class="number">0x56</span>, <span class="number">0xB6</span>, <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0xEE</span>, <span class="number">0x92</span>,</span><br><span class="line">      <span class="number">0x5C</span>, <span class="number">0xF2</span>, <span class="number">0xED</span>, <span class="number">0x0A</span>, <span class="number">0x5F</span>, <span class="number">0x36</span>, <span class="number">0x8E</span>, <span class="number">0x41</span>, <span class="number">0xA6</span>, <span class="number">0x36</span>,</span><br><span class="line">      <span class="number">0x86</span>, <span class="number">0x72</span>, <span class="number">0x56</span>, <span class="number">0xD2</span>, <span class="number">0x54</span>, <span class="number">0xC2</span>, <span class="number">0x00</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span>  key[] = Welcome to the game!\nYour key: ;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">teaDecrypt</span>((<span class="type">uint32_t</span>*)(data + <span class="number">4</span>), key, <span class="number">0xC</span>);</span><br><span class="line">    <span class="built_in">teaDecrypt</span>((<span class="type">uint32_t</span>*)(data + <span class="number">20</span>), key + <span class="number">16</span>, <span class="number">0xC</span>);</span><br><span class="line">    <span class="built_in">reverseBit</span>(data, <span class="number">36</span>);</span><br><span class="line">    <span class="built_in">puts</span>((<span class="type">char</span> *)data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>解得Flag<ul>
<li>  N0opa_G3Ey#zTXjmi5wIHd&amp;5pRN2elaNjK*C</li>
</ul>
</li>
</ul>
<h2 id="最后鸣谢"><a href="#最后鸣谢" class="headerlink" title="最后鸣谢"></a>最后鸣谢</h2><ul>
<li>  “#” 提供思路</li>
<li>  以及以上所有参考的文章的博主！！！</li>
</ul>
<h1 id="PyRE"><a href="#PyRE" class="headerlink" title="PyRE"></a>PyRE</h1><h2 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h2><ul>
<li>  直接下载程序，根绝标题和题目描述</li>
<li>  ”这种exe文件怎么调用py的库？要怎么逆呢，小明同学，你来试试吧？“</li>
<li>  不难得知此程序是Python的一道Re。</li>
<li>  使用010Editor查看一下当前程序的版本号。由下图不难看出使用了python3.7进行程序的编译</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/yYtzJBuQNKdDxrE.png"></p>
<h2 id="环境的切换"><a href="#环境的切换" class="headerlink" title="环境的切换"></a><strong>环境的切换</strong></h2><p>环境的切换是非必要的，但不切换在反汇编的时候可能会产生一些错误</p>
<ul>
<li>  如果安装的是python3.7的环境即可跳过本步骤</li>
<li>  如果安装了conda可以看下面快速切换，如果没有则需要自己去官网下载对应的版本进行切换</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#安装python3.7</span><br><span class="line">conda create -n py37 python=3.7  </span><br><span class="line"></span><br><span class="line">#切换python3.7环境</span><br><span class="line">conda activate py37</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/07/29/1S6khEGvRAOsZrD.png"></p>
<h2 id="程序的逆向"><a href="#程序的逆向" class="headerlink" title="程序的逆向"></a><strong>程序的逆向</strong></h2><ul>
<li>  到 <a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a>下载逆向脚本，使用命令进行逆向</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pyinstxtractor.py [ProgramFilePath]</span><br></pre></td></tr></table></figure>

<ul>
<li>  逆向之后会在pyinstxtractor脚本所在的目录生成一个xxx.exe_extracted的文件夹 。在文件夹中找到一个名字看起来最奇怪的.pyc结尾的文件</li>
</ul>
<p><img src="https://s2.loli.net/2022/07/29/4zJScQR5YefgPuF.png"></p>
<ul>
<li>  打开 <a target="_blank" rel="noopener" href="https://tool.lu/pyc/">在线PYC反编译</a></li>
<li>  把文件丢上去直接反编译出源码</li>
<li>  But！！！这样做会发现源码中有对b这个变量进行了运算，但是 b 这个变量却是None</li>
<li>  使用python标准库自带的marsha和dis库对pyc二进制文件进行反汇编。运行后会自动在窗口中打开bytecode将其复制到文件中分析得知</li>
<li>  b的值是179</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line">   <span class="keyword">import</span> dis</span><br><span class="line">   <span class="keyword">with</span> <span class="built_in">open</span>(rFilePath\pyre.exe_extracted\<span class="number">1.</span>pyc,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">       dis.dis(marshal.loads(f.read()[<span class="number">16</span>:]))</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/07/29/wSTEpvMWIshrLy6.png"><img src="https://s2.loli.net/2022/07/29/vwgZBA468pDJMti.png"><img src="https://s2.loli.net/2022/07/29/RNvdIO8kT2wiPBx.png"></p>
<h2 id="编写解密脚本"><a href="#编写解密脚本" class="headerlink" title="编写解密脚本"></a>编写解密脚本</h2><ul>
<li>根据上面的分析不难看出其实就是一个简单的算法<ul>
<li>  <code>ord(a[i]) * 33 % b != c[i]</code></li>
</ul>
</li>
<li>  拿数组中的每一个数值和输入的flag进行运算后的值对比判断是否一致，如果都一致则验证成功</li>
<li>  那么我们可以尝试直接使用爆破</li>
<li>首先下面是已知信息<ul>
<li>  数组c</li>
<li>  变量b的值</li>
<li>  立即数33</li>
</ul>
</li>
<li>  根据flag都是可见字符得知，可以使用ASCII编码表中0x21-0x7E的值对flag进行模拟判断是否和数组c中的每个元素相等即可。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = [</span><br><span class="line">    <span class="number">144</span>, <span class="number">163</span>, <span class="number">158</span>, <span class="number">177</span>, <span class="number">121</span>, <span class="number">39</span>, <span class="number">58</span>, <span class="number">58</span>, <span class="number">91</span>, <span class="number">111</span>, <span class="number">25</span>, <span class="number">158</span>, <span class="number">72</span>, <span class="number">53</span>, <span class="number">152</span>, <span class="number">78</span>, <span class="number">171</span>, <span class="number">12</span>, <span class="number">53</span>, <span class="number">105</span>, <span class="number">45</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">53</span>, <span class="number">12</span>, <span class="number">171</span>, <span class="number">111</span>, <span class="number">91</span>, <span class="number">53</span>, <span class="number">152</span>, <span class="number">105</span>, <span class="number">45</span>, <span class="number">152</span>, <span class="number">144</span>, <span class="number">39</span>, <span class="number">171</span>, <span class="number">45</span>, <span class="number">91</span>, <span class="number">78</span>, <span class="number">45</span>, <span class="number">158</span>, <span class="number">8</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">    b = <span class="number">179</span></span><br><span class="line"></span><br><span class="line">    flags = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x21</span>,<span class="number">0x7F</span>):</span><br><span class="line">            <span class="keyword">if</span> j * <span class="number">33</span> % b == c[i]:</span><br><span class="line">                flags.append(<span class="built_in">chr</span>(j))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;.join(flags))</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/07/29/zUymFbMYqAgKeu7.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.jamiexu.cn/">Jamie793</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.jamiexu.cn/2022/06/08/%E3%80%90ctf-wp-re%E3%80%91%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B9%BF%E4%B8%9C%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B-re/">https://blog.jamiexu.cn/2022/06/08/%E3%80%90ctf-wp-re%E3%80%91%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B9%BF%E4%B8%9C%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B-re/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.jamiexu.cn" target="_blank">Jamie793’ S Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/09/%E3%80%90ctf-wp-crypto%E3%80%91%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B9%BF%E4%B8%9C%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B/"><img class="prev-cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【CTF/WP/Crypto】第二届广东大学生网络安全攻防大赛</div></div></a></div><div class="next-post pull-right"><a href="/2022/06/05/%E3%80%90wp-ctf%E3%80%91rctf-2018-simple-vm/"><img class="next-cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【WP/CTF】RCTF 2018 Simple vm</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/01/%E3%80%90CTF&WriteUP&Re%E3%80%912022%E5%BC%BA%E7%BD%91%E6%9D%AF%20%E2%80%9DReverse%E2%80%9C%20WriteUp/" title="【CTF&amp;WriteUP&amp;Re】2022强网杯 ”Reverse“ WriteUp"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-01</div><div class="title">【CTF&amp;WriteUP&amp;Re】2022强网杯 ”Reverse“ WriteUp</div></div></a></div><div><a href="/2022/07/17/%E3%80%90ctfwriteup%E3%80%91%E5%BC%BA%E5%9B%BD%E6%9D%AF-2022-07%E7%BA%BF%E4%B8%8A%E6%AF%94%E8%B5%9Bwp/" title="【CTF&amp;WriteUp】2022-07 “强国杯” WriteUp含Re"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-17</div><div class="title">【CTF&amp;WriteUp】2022-07 “强国杯” WriteUp含Re</div></div></a></div><div><a href="/2022/06/01/%E3%80%90wp%E3%80%91ddctf-2018%E9%BB%91%E7%9B%92%E7%A0%B4%E8%A7%A3-%E7%AE%80%E5%8D%95%E7%9A%84vm%E5%85%A5%E9%97%A8/" title="【CTF&#x2F;WP】DDCTF 2018黑盒破解——简单的VM入门"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-01</div><div class="title">【CTF&#x2F;WP】DDCTF 2018黑盒破解——简单的VM入门</div></div></a></div><div><a href="/2022/06/05/%E3%80%90wp-ctf%E3%80%91rctf-2018-simple-vm/" title="【WP&#x2F;CTF】RCTF 2018 Simple vm"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-05</div><div class="title">【WP&#x2F;CTF】RCTF 2018 Simple vm</div></div></a></div><div><a href="/2021/07/07/c%E5%B8%B8%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%B8%B8%E5%87%BD%E6%95%B0/" title="c++常对象和常函数"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-07</div><div class="title">c++常对象和常函数</div></div></a></div><div><a href="/2021/07/07/c%E4%B8%AD%E7%9A%84cin/" title="C++中的cin"><img class="cover" src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-07</div><div class="title">C++中的cin</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2022/07/29/exB2qQKoj37pCIl.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jamie793</div><div class="author-info__description">Welcome to here</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">71</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">24</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;amp;uin=3510088586"><i class="fab fa-qq"></i><span>Contact Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;amp;uin=3510088586" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=AGilPtQKDoYvOPwqRBH0DDqcvqfjAZlf" target="_blank" title="QQGroup"><i class="fa fa-user-group"></i></a><a class="social-icon" href="https://space.bilibili.com/88716390" target="_blank" title="哔哩哔哩"><i class="fab fa-bilibili"></i></a><a class="social-icon" href="https://github.com/Jamie793" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://gitee.com/Jamie793" target="_blank" title="Gitee"><i class="fab fa-git-alt"></i></a><a class="social-icon" href="/doxm@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#LUOJIABASUO"><span class="toc-number">1.</span> <span class="toc-text">LUOJIABASUO</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RE"><span class="toc-number">2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">2.1.</span> <span class="toc-text">反调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">逻辑分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E9%B8%A3%E8%B0%A2"><span class="toc-number">2.3.</span> <span class="toc-text">最后鸣谢</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PyRE"><span class="toc-number">3.</span> <span class="toc-text">PyRE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">程序分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E7%9A%84%E5%88%87%E6%8D%A2"><span class="toc-number">3.2.</span> <span class="toc-text">环境的切换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E7%9A%84%E9%80%86%E5%90%91"><span class="toc-number">3.3.</span> <span class="toc-text">程序的逆向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-number">3.4.</span> <span class="toc-text">编写解密脚本</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/26/Untitled/" title="无题"><img src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2024/12/26/Untitled/" title="无题">无题</a><time datetime="2024-12-26T06:10:44.529Z" title="发表于 2024-12-26 14:10:44">2024-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/06/%E3%80%90%E5%8D%95%E7%89%87%E6%9C%BA&amp;FreeRTOS%E3%80%91RTOS%E7%A7%BB%E6%A4%8D%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/" title="【单片机FreeRTOS】RTOS移植常见错误"><img src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【单片机FreeRTOS】RTOS移植常见错误"/></a><div class="content"><a class="title" href="/2024/11/06/%E3%80%90%E5%8D%95%E7%89%87%E6%9C%BA&amp;FreeRTOS%E3%80%91RTOS%E7%A7%BB%E6%A4%8D%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/" title="【单片机FreeRTOS】RTOS移植常见错误">【单片机FreeRTOS】RTOS移植常见错误</a><time datetime="2024-11-06T00:31:00.000Z" title="发表于 2024-11-06 08:31:00">2024-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/03/%E3%80%90RTOS&amp;FreeRTOS&amp;%E5%B5%8C%E5%85%A5%E5%BC%8F%E3%80%91%E5%9F%BA%E4%BA%8ESTM32%20%E7%9A%84FreeRTOS%E5%86%85%E6%A0%B8%E5%89%96%E6%9E%90/" title="【RTOS&amp;FreeRTOS&amp;嵌入式】基于STM32 的FreeRTOS内核剖析"><img src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【RTOS&amp;FreeRTOS&amp;嵌入式】基于STM32 的FreeRTOS内核剖析"/></a><div class="content"><a class="title" href="/2023/09/03/%E3%80%90RTOS&amp;FreeRTOS&amp;%E5%B5%8C%E5%85%A5%E5%BC%8F%E3%80%91%E5%9F%BA%E4%BA%8ESTM32%20%E7%9A%84FreeRTOS%E5%86%85%E6%A0%B8%E5%89%96%E6%9E%90/" title="【RTOS&amp;FreeRTOS&amp;嵌入式】基于STM32 的FreeRTOS内核剖析">【RTOS&amp;FreeRTOS&amp;嵌入式】基于STM32 的FreeRTOS内核剖析</a><time datetime="2023-09-03T12:52:00.000Z" title="发表于 2023-09-03 20:52:00">2023-09-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/20/%E3%80%90STM32&amp;I2C(IIC)&amp;ROM&amp;RAM&amp;Proteus%E3%80%91IIC%E5%8D%8F%E8%AE%AE%E5%92%8C%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%9F%BA%E4%BA%8ESTM32%E7%9A%84Proteus%E4%B8%8BI2C%E4%BB%BF%E7%9C%9F/" title="【STM32&amp;I2C(IIC)&amp;Proteus】基于STM32的Proteus下I2C仿真"><img src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【STM32&amp;I2C(IIC)&amp;Proteus】基于STM32的Proteus下I2C仿真"/></a><div class="content"><a class="title" href="/2023/04/20/%E3%80%90STM32&amp;I2C(IIC)&amp;ROM&amp;RAM&amp;Proteus%E3%80%91IIC%E5%8D%8F%E8%AE%AE%E5%92%8C%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%9F%BA%E4%BA%8ESTM32%E7%9A%84Proteus%E4%B8%8BI2C%E4%BB%BF%E7%9C%9F/" title="【STM32&amp;I2C(IIC)&amp;Proteus】基于STM32的Proteus下I2C仿真">【STM32&amp;I2C(IIC)&amp;Proteus】基于STM32的Proteus下I2C仿真</a><time datetime="2023-04-20T12:23:00.000Z" title="发表于 2023-04-20 20:23:00">2023-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/23/%E3%80%90ESP32%20&amp;%20Arduino%E3%80%91ESP32%E5%85%A5%E9%97%A8%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E4%B9%8B%E7%82%B9%E4%BA%AE%E7%AC%AC%E4%B8%80%E9%A2%97LED/" title="【ESP32 &amp; Arduino】ESP32入门之环境安装"><img src="https://s2.loli.net/2022/07/29/tyqRcwWi5eKQoZP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【ESP32 &amp; Arduino】ESP32入门之环境安装"/></a><div class="content"><a class="title" href="/2022/11/23/%E3%80%90ESP32%20&amp;%20Arduino%E3%80%91ESP32%E5%85%A5%E9%97%A8%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E4%B9%8B%E7%82%B9%E4%BA%AE%E7%AC%AC%E4%B8%80%E9%A2%97LED/" title="【ESP32 &amp; Arduino】ESP32入门之环境安装">【ESP32 &amp; Arduino】ESP32入门之环境安装</a><time datetime="2022-11-23T14:36:00.000Z" title="发表于 2022-11-23 22:36:00">2022-11-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Jamie793</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="http://www.beian.gov.cn/img/new/gongan.png"/><span>粤ICP备20054250号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>